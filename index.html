<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body, input, button, select, a {
      font-family: 'Roboto', sans-serif; /* Apply Roboto font to all text */
    }

    body {
      margin: 0;
      display: grid;
      place-items: center;
      height: 100vh;
      background: linear-gradient(to right, #83a4d4, #b6fbff);
    }

    header {
      text-align: center;
      width: 100%;
      padding: 20px 0;
    }

    #logo img {
      transform: scale(0.7);
      display: inline-block;
    }

    #available-points {
      text-align: center;
      font-size: 40px;
      margin-bottom: 10px; /* Adjust the margin as needed */
    }

    [role="progressbar"] {
      --size: 300px;
      --value: 0; /* Initial value */
      width: var(--size);
      height: 50px; /* Set a fixed height for the progress bar */
      border-radius: 25px; /* Rounded edges for progress bar */
      background: gray; /* Default background color */
      position: relative;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      margin-top: 10px; /* Adjust the margin as needed */
    }

    footer {
      text-align: center;
      padding: 20px 0;
      width: 100%;
    }
  </style>
</head>
<body>
  <header>
    <a href="https://tforce.ch/" target="_blank" id="logo">
      <img src="logo.png" alt="Task Force Event Logistique Logo">
    </a>
  </header>

  <div id="available-points">Available Points</div>
  <div id="progressbar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="--value: 0;"></div>

  <footer>
    <a href="https://www.facebook.com" target="_blank" style="margin: 0 10px; color: #4373b9;"><i class="fab fa-facebook-f"></i></a>
    <a href="https://www.instagram.com" target="_blank" style="margin: 0 10px; color: #4373b9;"><i class="fab fa-instagram"></i></a>
    <a href="https://www.linkedin.com" target="_blank" style="margin: 0 10px; color: #4373b9;"><i class="fab fa-linkedin-in"></i></a>
    <p style="font-size: 10px; color: #4373b9; margin-top: 20px;">Powered by RushB!</p>
  </footer>

  <script>
    // Define gradients
    const gradients = {
      red: { start: '#ff9999', end: '#8b0000' },
      yellow: { start: '#ffff99', end: '#ffcc00' },
      green: { start: '#99ff99', end: '#006400' }
    };

    // Function to get and display points
    function getPoints(id) {
      return new Promise((resolve, reject) => {
        fetch("https://qr-app-o5ud4o55aa-ey.a.run.app/getgoogle", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify({ id: id })
        })
        .then(response => response.json())
        .then(data => {
          const points = parseInt(data.points, 10);
          document.getElementById('available-points').textContent = `Points: ${points}`;
          document.getElementById('progressbar').style.setProperty('--value', points);
          updateProgressBarColor(points); // Update the progress bar color
          resolve(points);
        })
        .catch(error => {
          console.error("Failed to retrieve points:", error);
          reject(error);
        });
      });
    }

    // Function to update the progress bar color based on points
    function updateProgressBarColor(points) {
      const progressbar = document.getElementById('progressbar');
      let gradient;

      if (points < 20) {
        gradient = gradients.red;
      } else if (points >= 20 && points < 55) {
        gradient = gradients.yellow;
      } else {
        gradient = gradients.green;
      }

      // Apply the new gradient to the progress bar
      progressbar.style.background = `linear-gradient(to right, ${gradient.start}, ${gradient.end})`;
    }

    // Extract the 'id' parameter from the URL
    const urlParams = new URLSearchParams(window.location.search);
    const idValue = urlParams.get("id");

    // Call getPoints if 'id' parameter exists
    if (idValue) {
      getPoints(idValue);
    }
  </script>
</body>
</html>
